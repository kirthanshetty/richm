require(["video"],function(){videojs.Youtube=videojs.MediaTechController.extend({init:function(e,t,n){videojs.MediaTechController.call(this,e,t,n),this.features.fullscreenResize=!0,this.player_=e,this.player_el_=document.getElementById(this.player_.id());if("undefined"!=typeof t.source)for(var r in t.source)this.player_.options()[r]=t.source[r];this.player_.options().ytcontrols&&this.player_.controls(!1),this.videoId=videojs.Youtube.parseVideoId(this.player_.options().src);if("undefined"!=typeof this.videoId&&!this.player_.options().ytcontrols){"undefined"==typeof this.player_.poster()&&this.player_.poster("http://img.youtube.com/vi/"+this.videoId+"/0.jpg");var i=this;setTimeout(function(){i.player_.posterImage.el().style.backgroundSize="cover"},50)}this.id_=this.player_.id()+"_youtube_api",this.el_=videojs.Component.prototype.createEl("iframe",{id:this.id_,className:"vjs-tech",scrolling:"no",marginWidth:0,marginHeight:0,frameBorder:0,webkitAllowFullScreen:"",mozallowfullscreen:"",allowFullScreen:""}),this.player_el_.insertBefore(this.el_,this.player_el_.firstChild),e={enablejsapi:1,iv_load_policy:3,playerapiid:this.id(),disablekb:1,wmode:"transparent",controls:this.player_.options().ytcontrols?1:0,showinfo:0,modestbranding:1,rel:0,autoplay:this.player_.options().autoplay?1:0,loop:this.player_.options().loop?1:0,list:videojs.Youtube.parsePlaylist(this.player_.options().src)},"undefined"==typeof e.list&&delete e.list,this.player_.options().autoplay&&(this.playOnReady=!0),"file:"!=window.location.protocol&&(e.origin=window.location.protocol+"//"+window.location.hostname),this.el_.src="http://www.youtube.com/embed/"+this.videoId+"?"+videojs.Youtube.makeQueryString(e),this.player_.options().ytcontrols&&(i=this,setTimeout(function(){var e=i.player_.bigPlayButton.el();e.parentNode.removeChild(e),e=i.player_.controlBar.el(),e.parentNode.removeChild(e)},50)),videojs.Youtube.apiReady?this.loadYoutube():(videojs.Youtube.loadingQueue.push(this),videojs.Youtube.apiLoading||(e=document.createElement("script"),e.src="http://www.youtube.com/iframe_api",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t),videojs.Youtube.apiLoading=!0))}}),videojs.Youtube.prototype.dispose=function(){this.el_&&this.el_.parentNode.removeChild(this.el_),this.ytplayer&&this.ytplayer.destroy(),videojs.MediaTechController.prototype.dispose.call(this)},videojs.Youtube.prototype.src=function(e){this.ytplayer.loadVideoById({videoId:videojs.Youtube.parseVideoId(e),list:videojs.Youtube.parsePlaylist(e)})},videojs.Youtube.prototype.play=function(){this.isReady_?this.ytplayer.playVideo():this.playOnReady=!0},videojs.Youtube.prototype.pause=function(){this.ytplayer.pauseVideo()},videojs.Youtube.prototype.paused=function(){return this.lastState!==YT.PlayerState.PLAYING&&this.lastState!==YT.PlayerState.BUFFERING},videojs.Youtube.prototype.currentTime=function(){return this.ytplayer.getCurrentTime()},videojs.Youtube.prototype.setCurrentTime=function(e){this.ytplayer.seekTo(e,!0),this.player_.trigger("timeupdate")},videojs.Youtube.prototype.duration=function(){return this.ytplayer.getDuration()},videojs.Youtube.prototype.buffered=function(){var e=this.ytplayer.getVideoBytesLoaded(),t=this.ytplayer.getVideoBytesTotal();if(!e||!t)return 0;var n=this.ytplayer.getDuration(),e=e/t*n,t=this.ytplayer.getVideoStartBytes()/t*n;return videojs.createTimeRange(t,t+e)},videojs.Youtube.prototype.volume=function(){return isNaN(this.volumeVal)&&(this.volumeVal=this.ytplayer.getVolume()/100),this.volumeVal},videojs.Youtube.prototype.setVolume=function(e){e&&e!=this.volumeVal&&(this.ytplayer.setVolume(100*e),this.volumeVal=e,this.player_.trigger("volumechange"))},videojs.Youtube.prototype.muted=function(){return this.ytplayer.isMuted()},videojs.Youtube.prototype.setMuted=function(e){e?this.ytplayer.mute():this.ytplayer.unMute();var t=this;setTimeout(function(){t.player_.trigger("volumechange")},50)},videojs.Youtube.prototype.onReady=function(){this.isReady_=!0,this.player_.trigger("techready"),this.triggerReady(),this.player_.trigger("durationchange"),this.playOnReady&&this.ytplayer.playVideo()},videojs.Youtube.prototype.onStateChange=function(e){if(e!=this.lastState){switch(e){case-1:this.player_.trigger("durationchange");break;case YT.PlayerState.ENDED:this.player_.trigger("ended");break;case YT.PlayerState.PLAYING:this.player_.trigger("timeupdate"),this.player_.trigger("durationchange"),this.player_.trigger("playing"),this.player_.trigger("play");break;case YT.PlayerState.PAUSED:this.player_.trigger("pause");break;case YT.PlayerState.BUFFERING:this.player_.trigger("timeupdate"),this.player_.trigger("waiting")}this.lastState=e}},videojs.Youtube.prototype.onPlaybackQualityChange=function(e){switch(e){case"medium":this.player_.videoWidth=480,this.player_.videoHeight=360;break;case"large":this.player_.videoWidth=640,this.player_.videoHeight=480;break;case"hd720":this.player_.videoWidth=960,this.player_.videoHeight=720;break;case"hd1080":this.player_.videoWidth=1440,this.player_.videoHeight=1080;break;case"highres":this.player_.videoWidth=1920,this.player_.videoHeight=1080;break;case"small":this.player_.videoWidth=320,this.player_.videoHeight=240;break;default:this.player_.videoWidth=0,this.player_.videoHeight=0}this.player_.trigger("ratechange")},videojs.Youtube.prototype.onError=function(e){this.player_.error=e,this.player_.trigger("error")},videojs.Youtube.isSupported=function(){return!0},videojs.Youtube.prototype.supportsFullScreen=function(){return!1},videojs.Youtube.canPlaySource=function(e){return"video/youtube"==e.type},videojs.Youtube.loadingQueue=[],videojs.Youtube.prototype.loadYoutube=function(){this.ytplayer=new YT.Player(this.id_,{events:{onReady:function(e){e.target.vjsTech.onReady()},onStateChange:function(e){e.target.vjsTech.onStateChange(e.data)},onPlaybackQualityChange:function(e){e.target.vjsTech.onPlaybackQualityChange(e.data)},onError:function(e){e.target.vjsTech.onError(e.data)}}}),this.ytplayer.vjsTech=this},videojs.Youtube.makeQueryString=function(e){var t=[],n;for(n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},videojs.Youtube.parseVideoId=function(e){if((e=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/))&&11==e[2].length)return e[2]},videojs.Youtube.parsePlaylist=function(e){e=e.match(/[?&]list=([^#\&\?]+)/);if(null!=e&&1<e.length)return e[1]},window.onYouTubeIframeAPIReady=function(){for(var e;e=videojs.Youtube.loadingQueue.shift();)e.loadYoutube();videojs.Youtube.loadingQueue=[],videojs.Youtube.apiReady=!0}});